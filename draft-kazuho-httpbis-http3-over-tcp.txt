



httpbis                                                           K. Oku
Internet-Draft                                                    Fastly
Intended status: Standards Track                        27 November 2023
Expires: 30 May 2024


                            HTTP/3 over TCP
               draft-kazuho-httpbis-http3-over-tcp-latest

Abstract

   This document specifies how to use HTTP/3 on top of TCP.

Discussion Venues

   This note is to be removed before publishing as an RFC.

   Discussion of this document takes place on the HTTP Working Group
   mailing list (ietf-http-wg@w3.org), which is archived at
   https://lists.w3.org/Archives/Public/ietf-http-wg/.

   Source for this draft and an issue tracker can be found at
   https://github.com/kazuho/draft-kazuho-httpbis-http3-over-tcp.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 30 May 2024.

Copyright Notice

   Copyright (c) 2023 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.

Table of Contents

   1.  Introduction
   2.  Conventions and Definitions
   3.  Starting HTTP/3 over TCP
   4.  Exchanging HTTP/3 Frames
   5.  Security Considerations
   6.  IANA Considerations
   7.  References
     7.1.  Normative References
     7.2.  Informative References
   Acknowledgments
   Author's Address

1.  Introduction

   In the year of 2023, HTTP/2 ([RFC9113]) is the most widely used
   version of HTTP across the Internet, while the adoption rate of
   HTTP/3 ([RFC9114]) is increasing rapidly.

   HTTP/3 has several benefits over HTTP/2 thanks to the use of QUIC
   ([RFC9000]) as the transport layer protocol that provides features
   such as stream multiplexing without head-of-line blocking, low-
   latency connection establishment.

   But because QUIC is not as universally available or accessible as
   TCP, it is unlikely that we will see all HTTP/2 traffic migrate to
   the QUIC-based HTTP/3.

   The fact means that HTTP deployments have to support two transport
   protocols and the HTTP versions running on each of them for the
   foreseeable future.

   This is a costly situation, as the two HTTP protocols are different
   in many aspects, such as wire-encoding, flow control and stream
   multiplexing machinery, and HTTP header compression.  Extensions that
   work at the HTTP wire encoding layer have to be designed and
   implemented for both HTTP/2 and HTTP/3.  Both the protocol stacks
   have to be maintained, fixing bugs, performance issues, and
   vulnerabilities as necessary.

   This specification resolves the problem by defining a way to run
   HTTP/3 on top of TCP, by using Quic Services for Streams ([QSS]) as
   the basis.  QUIC Services for Streams is a polyfill of QUIC that runs
   on top of bi-directional streams.  By using QUIC Services for
   Streams, it is possible to run HTTP/3 on top of TCP without
   modification.

   Design, implementation, and maintenance can focus on just one HTTP
   version: HTTP/3.

2.  Conventions and Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  Starting HTTP/3 over TCP

   HTTP/3 over TCP can be used for “http” and “https” URI schemes
   defined in Section 4.2 of [RFC9110] with the same default port
   numbers as HTTP/1.1 ([RFC9112]).

   When starting HTTP/3 for “https” URIs on top of TCP, clients use the
   TLS ([RFC8446]) with the ALPN ([RFC7301]) extension: “h3t”.

   Also, clients may learn that a particular server supports HTTP/3 over
   TCP by other means.  A client that knows that a server supports
   HTTP/3 over TCP can establish a TCP connection and start exchanging
   HTTP/3 frames using QUIC Services for Streams.

   The latter is the only way to discover HTTP/3 over TCP for “http”
   URIs.

   When used in cleartext, servers can determine if or not the client is
   speaking HTTP/3 over TCP by comparing the first eight bytes to the
   encoded form of the QSS_TRANSPORT_PARAMETERS frame type (Section 4.2
   of [QSS]).

4.  Exchanging HTTP/3 Frames

   Once the TCP connection is setup and the Transport Parameters are
   exchanged by QUIC Services for Streams, endpoints can exchange the
   HTTP/3 frames as if the underlying connection was QUIC.

5.  Security Considerations

   TODO Security

6.  IANA Considerations

   This document has no IANA actions.

7.  References

7.1.  Normative References

   [QSS]      "*** BROKEN REFERENCE ***".

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC7301]  Friedl, S., Popov, A., Langley, A., and E. Stephan,
              "Transport Layer Security (TLS) Application-Layer Protocol
              Negotiation Extension", RFC 7301, DOI 10.17487/RFC7301,
              July 2014, <https://www.rfc-editor.org/rfc/rfc7301>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC8446]  Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", RFC 8446, DOI 10.17487/RFC8446, August 2018,
              <https://www.rfc-editor.org/rfc/rfc8446>.

   [RFC9110]  Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke,
              Ed., "HTTP Semantics", STD 97, RFC 9110,
              DOI 10.17487/RFC9110, June 2022,
              <https://www.rfc-editor.org/rfc/rfc9110>.

   [RFC9112]  Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke,
              Ed., "HTTP/1.1", STD 99, RFC 9112, DOI 10.17487/RFC9112,
              June 2022, <https://www.rfc-editor.org/rfc/rfc9112>.

   [RFC9114]  Bishop, M., Ed., "HTTP/3", RFC 9114, DOI 10.17487/RFC9114,
              June 2022, <https://www.rfc-editor.org/rfc/rfc9114>.

7.2.  Informative References

   [RFC9000]  Iyengar, J., Ed. and M. Thomson, Ed., "QUIC: A UDP-Based
              Multiplexed and Secure Transport", RFC 9000,
              DOI 10.17487/RFC9000, May 2021,
              <https://www.rfc-editor.org/rfc/rfc9000>.

   [RFC9113]  Thomson, M., Ed. and C. Benfield, Ed., "HTTP/2", RFC 9113,
              DOI 10.17487/RFC9113, June 2022,
              <https://www.rfc-editor.org/rfc/rfc9113>.

Acknowledgments

   TODO acknowledge.

Author's Address

   Kazuho Oku
   Fastly
   Email: kazuhooku@gmail.com
